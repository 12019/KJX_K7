/*****************************************************************************
*  Copyright Statement:
*  --------------------
*  This software is protected by Copyright and the information contained
*  herein is confidential. The software may not be copied and the information
*  contained herein may not be used or disclosed except with the written
*  permission of MediaTek Inc. (C) 2008
*
*  BY OPENING THIS FILE, BUYER HEREBY UNEQUIVOCALLY ACKNOWLEDGES AND AGREES
*  THAT THE SOFTWARE/FIRMWARE AND ITS DOCUMENTATIONS ("MEDIATEK SOFTWARE")
*  RECEIVED FROM MEDIATEK AND/OR ITS REPRESENTATIVES ARE PROVIDED TO BUYER ON
*  AN "AS-IS" BASIS ONLY. MEDIATEK EXPRESSLY DISCLAIMS ANY AND ALL WARRANTIES,
*  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF
*  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR NONINFRINGEMENT.
*  NEITHER DOES MEDIATEK PROVIDE ANY WARRANTY WHATSOEVER WITH RESPECT TO THE
*  SOFTWARE OF ANY THIRD PARTY WHICH MAY BE USED BY, INCORPORATED IN, OR
*  SUPPLIED WITH THE MEDIATEK SOFTWARE, AND BUYER AGREES TO LOOK ONLY TO SUCH
*  THIRD PARTY FOR ANY WARRANTY CLAIM RELATING THERETO. MEDIATEK SHALL ALSO
*  NOT BE RESPONSIBLE FOR ANY MEDIATEK SOFTWARE RELEASES MADE TO BUYER'S
*  SPECIFICATION OR TO CONFORM TO A PARTICULAR STANDARD OR OPEN FORUM.
*
*  BUYER'S SOLE AND EXCLUSIVE REMEDY AND MEDIATEK'S ENTIRE AND CUMULATIVE
*  LIABILITY WITH RESPECT TO THE MEDIATEK SOFTWARE RELEASED HEREUNDER WILL BE,
*  AT MEDIATEK'S OPTION, TO REVISE OR REPLACE THE MEDIATEK SOFTWARE AT ISSUE,
*  OR REFUND ANY SOFTWARE LICENSE FEES OR SERVICE CHARGE PAID BY BUYER TO
*  MEDIATEK FOR SUCH MEDIATEK SOFTWARE AT ISSUE. 
*
*  THE TRANSACTION CONTEMPLATED HEREUNDER SHALL BE CONSTRUED IN ACCORDANCE
*  WITH THE LAWS OF THE STATE OF CALIFORNIA, USA, EXCLUDING ITS CONFLICT OF
*  LAWS PRINCIPLES. ANY DISPUTES, CONTROVERSIES OR CLAIMS ARISING THEREOF AND
*  RELATED THERETO SHALL BE SETTLED BY ARBITRATION IN SAN FRANCISCO, CA, UNDER
*  THE RULES OF THE INTERNATIONAL CHAMBER OF COMMERCE (ICC).
*
*****************************************************************************/

/*******************************************************************************
 * Filename:
 * ---------
 *  vapp_callset.h
 *
 * Project:
 * --------
 *  Venus
 *
 * Description:
 * ------------
 *  
 *
 * Author:
 * -------
 * -------
 *
 *============================================================================
 *             HISTORY
 * Below this line, this part is controlled by PVCS VM. DO NOT MODIFY!!
 *------------------------------------------------------------------------------
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 *
 *------------------------------------------------------------------------------
 * Upper this line, this part is controlled by PVCS VM. DO NOT MODIFY!!
 *============================================================================
 ****************************************************************************/
#ifndef __VAPP_CALLSET_H__
#define __VAPP_CALLSET_H__


/***************************************************************************** 
 * Include
 *****************************************************************************/
#include "MMIDataType.h" /* mmi_id */

extern "C" 
{
#include "CallSetSrvGprot.h"
#include "SsSrvGprot.h"
}


#include "vfx_datatype.h"
#include "vfx_main_scr.h"
#include "vfx_page.h"
#include "vfx_weak_ptr.h"

#include "vcp_list_menu.h"
#include "vcp_menu_popup.h"
#ifdef __MMI_UCM_REJECT_BY_SMS__
#include "Vapp_text_template_scrn.h" /* VappTextTemplatePage */
#endif /* __MMI_UCM_REJECT_BY_SMS__ */

/***************************************************************************** 
 * Define
 *****************************************************************************/

#define VAPP_CALLSET_FAIL_POPUP(_parent, _text)             \
    do                                                      \
    {                                                       \
        mmi_frm_nmgr_balloon(MMI_SCENARIO_ID_DEFAULT,       \
                             MMI_EVENT_INFO_BALLOON,        \
                             MMI_NMGR_BALLOON_TYPE_FAILURE, \
                             (WCHAR*)_text.getBuf());       \
    } while(0)

// Internal use
// Some Network may  can't suport the cb Type, then we'll only query the voice call's cb
#define __MMI_CB_CALLTYPE_SUPPORT__

/***************************************************************************** 
 * Typedef
 *****************************************************************************/

typedef enum
{
    VAPP_CALLSET_FUNC_OK,
    VAPP_CALLSET_FUNC_CANCEL,
    VAPP_CALLSET_FUNC_PREV,
    VAPP_CALLSET_FUNC_NEXT,
    VAPP_CALLSET_FUNC_SEL_FROM_PHB
} VappCallSetFuncBarIdEnum;

/***************************************************************************** 
 * Class VappCallSetPageMain
 *****************************************************************************/
class VcpForm;
class VcpFormItemCell;
class VcpFormItemLauncherCell;
class VcpFormItemSwitchCell;

class VappCallSetPageMain : public VfxPage
{

public:
	VappCallSetPageMain();
    virtual ~VappCallSetPageMain();
public:
	static mmi_sim_enum s_cfuBit;
    void updateAccordingMode();
	
// Override
protected:
    virtual void onInit();
    virtual void onDeinit();
    virtual void onEnter(VfxBool isBackward);

private:
    void onItemTap(VcpFormItemCell *item, VfxId id);
	void onAniDone(VcpFormItemSwitchCell* item, VfxId id, VfxBool state);
    void onSwitch(VcpFormItemSwitchCell* item, VfxId id, VfxBool state);
    void updateForm(void);
    static mmi_ret hdlrModeChange(mmi_event_struct *evt);

	enum
	{
		ID_LAUNCH_CALLSET,
		ID_LAUNCH_CALLSET_BL = 1,
		ID_LAUNCH_CALLSET_WL = 12,
		ID_LAUNCH_CALLSET_REDIAL = 3,
		ID_LAUNCH_CALLSET_CTD = 2,
		ID_LAUNCH_CALLSET_IP_NUM = 4,
		ID_LAUNCH_CALLSET_CTR = 5,
		ID_LAUNCH_CALLSET_QUICK_END = 13,
		ID_LAUNCH_CALLSET_QUICK_END_TIME = 6,
		ID_LAUNCH_CALLSET_REJECT_UNKNOWN_CALLER = 16,
		ID_LAUNCH_CALLSET_REJECT_BY_SMS = 7,
		ID_LAUNCH_CALLSET_CONNECT_NOTICE = 14,
		ID_LAUNCH_CALLSET_ANSWER_MODE = 8,
		ID_LAUNCH_CALLSET_CTM = 15,
		ID_LAUNCH_CALLSET_CTM_MODE = 9,
		ID_LAUNCH_CALLSET_VT = 10,
		ID_LAUNCH_CALLSET_ADITIONAL_SETTINGS = 11
	};

    VcpFormItemLauncherCell *m_redial;
    VcpFormItemLauncherCell *m_ctr;
    VcpFormItemSwitchCell *m_quickEnd;
    VcpFormItemLauncherCell *m_quickEndTime;
    VcpFormItemLauncherCell *m_ctmSetting;
    VcpFormItemLauncherCell *m_additionalSetting;
	VcpForm *m_form;
};


/***************************************************************************** 
 * Class VappCallSetAsyncPage
 *****************************************************************************/
class VcpIndicatorPopup;
class VappCallSetAsyncPage : public VfxPage
{

public:
    virtual void onResult(mmi_event_struct *info) {}

// Override
protected:
    virtual void onInit();
    virtual void onEnter(VfxBool isBackward);
    virtual void onExit(VfxBool isBackward);

protected:
    enum
    {
        STATE_NONE = 0 /* canceled or no action */
    };

    void setCurrState(const VfxU32 &state);
    VfxU32 getCurrState(void);
    void showWaitPopup(const VfxWString &text, const VfxBool &allowCancel);
    void leaveWaitPopup(void);

private:
    void onCancelClicked(VfxObject* sender, VfxFloat progress);

    VfxU32 m_state;
    VcpIndicatorPopup *m_wait;
};
typedef VfxWeakPtr <VappCallSetAsyncPage> VappCallSetAsyncPageWeakPtr;


/***************************************************************************** 
 * Class VappCallSetPageCommonInputAsync
 *****************************************************************************/
class VappCallSetPageCommonInputAsync : public VappCallSetAsyncPage
{
public:
	VappCallSetPageCommonInputAsync(VfxBool isAsync = VFX_TRUE);

// Override
protected:
    virtual void onInit();

protected:
    void setInputBuf(const VfxU32 &maxInputLen, const VfxWString &defaultInput);
    virtual void onTextChanged(VcpTextEditor* editor);
    virtual void onFuncBtnClicked(VfxObject* sender, VfxId id);

    VcpTitleBar *m_titleBar;
    VfxTextFrame *m_mainText;
    VfxTextFrame *m_hint;
    VcpTextEditor *m_textInput;
    VcpFunctionBar *m_funcBar;
    VcpToolBar *m_toolBar;
	VfxBool m_isAsync;

};


/***************************************************************************** 
 * Class VappCallSetPageBL
 *****************************************************************************/
#ifdef __MMI_CM_BLACK_LIST__
class VappCallSetPageBL : public VfxPage
{

// Override
protected:
    virtual void onInit();
    virtual void onEnter(VfxBool isBackward);
    virtual mmi_ret onProc(mmi_event_struct *evt);

private:
    void onSwitch(VcpFormItemSwitchCell* item, VfxId id, VfxBool state);
    void onDel(VcpFormItemAidButtonCell* item, VfxId id);
    void onToolBarTapped(VfxObject* sender, VfxId id);
    void onCmdBtnClicked(VfxObject* sender, VfxId id);
    void onConfirmClicked(VfxObject* sender, VfxId id);
    void updateList(void);

    VcpForm *m_form;
    VcpToolBar *m_toolBar;
    VfxU32 m_minBlNumId;
    VfxU32 m_count;
    VfxWString m_tmpNum;
    mmi_id m_phbId;
};


/***************************************************************************** 
 * Class VappCallSetPageBLEdit
 *****************************************************************************/
class VappCallSetPageBLEdit : public VappCallSetPageCommonInputAsync
{
public:
	VappCallSetPageBLEdit() : VappCallSetPageCommonInputAsync(VFX_FALSE){}

// Override
protected:
    virtual void onInit();
    virtual void onFuncBtnClicked(VfxObject* sender, VfxId id);

};

#endif /* __MMI_CM_BLACK_LIST__ */


/***************************************************************************** 
 * Class VappCallSetPageWL
 *****************************************************************************/
#ifdef __MMI_CM_WHITE_LIST__
class VappCallSetPageWL : public VfxPage
{

// Override
protected:
    virtual void onInit();
    virtual void onEnter(VfxBool isBackward);
    virtual mmi_ret onProc(mmi_event_struct *evt);

private:
    void onSwitch(VcpFormItemSwitchCell* item, VfxId id, VfxBool state);
    void onDel(VcpFormItemAidButtonCell* item, VfxId id);
    void onDelContinue(void);
    void onToolBarTapped(VfxObject* sender, VfxId id);
    void onCmdBtnClicked(VfxObject* sender, VfxId id);
    void onConfirmClicked(VfxObject* sender, VfxId id);
    void onAddFromPhb(void);
    void updateList(void);

    VcpForm *m_form;
    VcpToolBar *m_toolBar;
    VfxU32 m_minWlNumId;
    VfxU32 m_count;
    VfxWString m_tmpNum;
    mmi_id m_phbId;
    mmi_id m_passwdId;
    void (VappCallSetPageWL::*m_func)(void);
    WCHAR m_num[MMI_PHB_NUMBER_PLUS_LENGTH + 1];
};


/***************************************************************************** 
 * Class VappCallSetPageWLEdit
 *****************************************************************************/
class VappCallSetPageWLEdit : public VappCallSetPageCommonInputAsync
{
public:
	VappCallSetPageWLEdit() : VappCallSetPageCommonInputAsync(VFX_FALSE){}

// Override
protected:
    virtual void onInit();
    virtual mmi_ret onProc(mmi_event_struct *evt);
    virtual void onFuncBtnClicked(VfxObject* sender, VfxId id);

private:
    void onAdd(void);

    mmi_id m_passwdId;
    void (VappCallSetPageWLEdit::*m_func)(void);

};
#endif /* __MMI_CM_WHITE_LIST__ */


class VappCallSetPageRedial : public VfxPage, public IVcpListMenuContentProvider
{

// Override IVcpListMenuContentProvider
public:
    virtual VfxBool getItemText(
        VfxU32 index,                    
        VcpListMenuFieldEnum fieldType,  
        VfxWString &text,                
        VcpListMenuTextColorEnum &color  
        );
    virtual VfxU32 getCount() const;
    virtual VcpListMenuItemStateEnum getItemState(
        VfxU32 index   
        ) const;

// Override VfxPage
protected:
    virtual void onInit();

private:
    void onSelect(VcpListMenu* menu, VfxU32 index, VcpListMenuItemStateEnum state);
    void onTapped(VcpListMenu* menu, VfxU32 index);

    VfxU32 m_activateIndex;
    VfxU32 m_count;
};


/***************************************************************************** 
 * Class VappCallSetPageIpNum
 *****************************************************************************/
#ifdef __IP_NUMBER__
class VappCallSetPageIpNumEdit : public VappCallSetPageCommonInputAsync
{
public:
	VappCallSetPageIpNumEdit():
    VappCallSetPageCommonInputAsync(VFX_FALSE)
    , m_index(0)
    {}
    void setNumIndex(VfxU8 idx);
// Override
protected:
    virtual void onInit();
    virtual void onFuncBtnClicked(VfxObject* sender, VfxId id);
    virtual void onTextChanged(VcpTextEditor* editor);
private:
    VfxU8 m_index;
};

class VappCallSetPageIpNum : public VfxPage, public IVcpListMenuContentProvider
{

// Override IVcpListMenuContentProvider
public:
    virtual VfxBool getItemText(
        VfxU32 index,                    
        VcpListMenuFieldEnum fieldType,  
        VfxWString &text,                
        VcpListMenuTextColorEnum &color  
        );
    virtual VfxBool getItemImage(
        VfxU32 index,
        VcpListMenuFieldEnum fieldType,
        VfxImageSrc &image
        );
    virtual VfxU32 getCount() const;
    virtual void onClickCmdButton(VcpListMenu *listmenu, VfxU32 index);
	virtual VfxBool getItemIsHighlightable(VfxU32 index) const;
// Override VfxPage
protected:
    virtual void onInit();
    virtual void onDeinit();
    virtual void onEnter(VfxBool isBackward);
private:
    void onTapped(VcpListMenu* menu, VfxU32 index);
    void onMenuSelected(VcpMenuPopup *menu, VcpMenuPopupEventEnum event, VcpMenuPopupItem *item);
    static mmi_ret hdlrSimAvailabilityChange(mmi_event_struct *evt);
    void updateIpNum();
    VcpListMenu *m_listmenu;
    VfxS8 m_selIndex;
    srv_callset_ip_number_struct m_ip_num; 
};
#endif /* __IP_NUMBER__ */


/***************************************************************************** 
 * Class VappCallSetPageCtr
 *****************************************************************************/
class VappCallSetPageCtr : public VfxPage, public IVcpListMenuContentProvider
{

// Override IVcpListMenuContentProvider
public:
    virtual VfxBool getItemText(
        VfxU32 index,                    
        VcpListMenuFieldEnum fieldType,  
        VfxWString &text,                
        VcpListMenuTextColorEnum &color  
        );
    virtual VfxU32 getCount() const;
    virtual VcpListMenuItemStateEnum getItemState(
        VfxU32 index   
        ) const;

// Override VfxPage
protected:
    virtual void onInit();

private:
    void onTapped(VcpListMenu* menu, VfxU32 index);

    VfxU32 m_activateIndex;
    VfxU32 m_count;
};


/***************************************************************************** 
 * Class VappCallSetPageCtrTime
 *****************************************************************************/
class VappCallSetPageCtrTime : public VappCallSetPageCommonInputAsync
{
public:
	VappCallSetPageCtrTime() : VappCallSetPageCommonInputAsync(VFX_FALSE){}

// Override
protected:
    virtual void onInit();
    virtual void onFuncBtnClicked(VfxObject* sender, VfxId id);

};


/***************************************************************************** 
 * Class VappCallSetPageQuickEnd
 *****************************************************************************/
#ifdef __MMI_CH_QUICK_END__
class VappCallSetPageQuickEnd : public VappCallSetPageCommonInputAsync
{
public:
	VappCallSetPageQuickEnd() : VappCallSetPageCommonInputAsync(VFX_FALSE){}

// Override
protected:
    virtual void onInit();
    virtual void onFuncBtnClicked(VfxObject* sender, VfxId id);

};
#endif /* __MMI_CH_QUICK_END__ */


/***************************************************************************** 
 * Class VappCallSetPageRejBySms
 *****************************************************************************/
#ifdef __MMI_UCM_REJECT_BY_SMS__
class VappCallSetPageRejBySms : public VfxPage
{

// Override
protected:
    virtual void onInit();

private:
    void onItemTap(VcpFormItemCell *item, VfxId id);
    void onSwitch(VcpFormItemSwitchCell* item, VfxId id, VfxBool state);
};


/***************************************************************************** 
 * Class VappCallSetPageSmsTemplate
 *****************************************************************************/
class VappCallSetPageSmsTemplate : public VappTextTemplatePage
{

// Override
protected:
    virtual void onInit();
	void onQueryRotateEx(VfxScreenRotateParam &param);

};

#endif /* __MMI_UCM_REJECT_BY_SMS__ */


/***************************************************************************** 
 * Class VappCallSetPageSimSel
 *****************************************************************************/
#if (MMI_MAX_SIM_NUM >= 2)
class VappCallSetPageSimSel : public VfxPage
{

// Override
protected:
    virtual void onInit();
    virtual void onDeinit();
    virtual void onEnter(VfxBool isBackward);

private:
    void onItemTap(VcpFormItemCell *item, VfxId id);
    void updateForm();
    static mmi_ret hdlrSimAvailabilityChange(mmi_event_struct *evt);

	VcpFormItemLauncherCell *m_launchSim[MMI_SIM_TOTAL];
};
#endif /* MMI_MAX_SIM_NUM */


/***************************************************************************** 
 * Class VappCallSetPageAdditional
 *****************************************************************************/
class VappCallSetPageAdditional : public VappCallSetAsyncPage
{

public:
    virtual void onResult(mmi_event_struct *info);
#ifdef __MMI_CALLSET_CALLER_ID__
	static mmi_ret onCallerIDCallback(mmi_event_struct *evt);
	void processCallIDEvt(mmi_event_struct *evt);
#endif
	static void sendAbortSS(void);

// Override
protected:
    virtual void onInit();
    virtual void onDeinit();
    virtual void onEnter(VfxBool isBackward);
    virtual void onExit(VfxBool isBackward);

private:
	void onSelectType(VfxId id, VfxU32 usrData);
    void onItemTap(VcpFormItemCell *item, VfxId id);
    void onSwitchCw(VcpFormItemSwitchCell* item, VfxId id, VfxBool state);
    void updateForm(void);
    void queryData(void);
	
#ifdef __MMI_CALLSET_CALLER_ID__
	void getCallerIdState(void);
	void onSwitchCallerId(VcpFormItemSwitchCell* item, VfxId id, VfxBool state);
#endif
    static mmi_ret hdlrSimAvailabilityChange(mmi_event_struct *evt);

    enum
    {
        STATE_SET_CW = STATE_NONE + 1,
        STATE_GET_CW,
        STATE_SET_CID,
        STATE_GET_CID,
        STATE_INVALID
    };

    VcpFormItemSwitchCell *m_cw;
    VfxBool m_cwEnabled;
#ifdef __MMI_CALLSET_CALLER_ID__
    VcpFormItemSwitchCell *m_cid;
    VfxBool m_cidEnabled;
#endif /* __MMI_CALLSET_CALLER_ID__ */
#ifdef __MMI_CALLSET_CUG__
    VcpFormItemLauncherCell *m_cug;
#endif /* __MMI_CALLSET_CUG__ */
    VcpFormItemLauncherCell *m_lsw;

    VfxU32 m_callerIdState;
    VfxBool m_waitValue;

};


/***************************************************************************** 
 * Class VappCallSetPageLsw
 *****************************************************************************/
class VappCallSetPageLsw : public VappCallSetAsyncPage, public IVcpListMenuContentProvider
{

// Override IVcpListMenuContentProvider
public:
    virtual VfxBool getItemText(
        VfxU32 index,                    
        VcpListMenuFieldEnum fieldType,  
        VfxWString &text,                
        VcpListMenuTextColorEnum &color  
        );
    virtual VfxU32 getCount() const;
    virtual VcpListMenuItemStateEnum getItemState(
        VfxU32 index   
        ) const;

// Override VappCallSetAsyncPage
    virtual void onResult(mmi_event_struct *info);

// Override VfxPage
protected:
    virtual void onInit();
    virtual void onExit(VfxBool isBackward);

private:
    enum
    {
        STATE_ACT = STATE_NONE + 1,
        STATE_ABORT,
        STATE_INVALID
    };

    void onTapped(VcpListMenu* menu, VfxU32 index);

    VfxU32 m_activateIndex;
    VfxU32 m_count;
};

/***************************************************************************** 
 * Class VappCallSetPageCfType
 *****************************************************************************/
class VappCallSetCallTypeSelPage : public VfxPage
{
public:
	VappCallSetCallTypeSelPage(VfxU32 data = 0) : m_usrData(data){}
	
	void setTitleString(const VfxWString &title);
	
	VfxSignal2<VfxId, VfxU32> m_signalCalType;
	
// Override
protected:
    virtual void onInit();

private:
    void onItemTap(VcpFormItemCell *item, VfxId id);
	
private:
	VfxU32 m_usrData;
};


/***************************************************************************** 
 * Class VappCallSetCntx
 *****************************************************************************/
class VappCallSetCntx : public VfxObject
{

public:
    VappCallSetCntx() :
        m_sim(MMI_SIM_NONE), 
        m_inActType(SRV_SS_ACTION_TYPE_TOTAL), m_inCallType(SRV_SS_CALL_TYPE_TOTAL),
        m_inCfType(SRV_SS_CALL_FORWARD_TYPE_UNKNOWN), m_inCfNum(NULL),
        m_cfuNum(VFX_WSTR_EMPTY), m_cfnrcNum(VFX_WSTR_EMPTY), m_cfnryNum(VFX_WSTR_EMPTY), 
        m_cfnryTime(5), 
        m_cfbNum(VFX_WSTR_EMPTY),
        m_inCbType(SRV_SS_CALL_BAR_TYPE_UNKNOWN),
    #ifdef __MMI_CH_QUICK_END__
        m_inQuickEnd(VFX_FALSE),
        m_inQuickEndTime(0),
    #endif /* __MMI_CH_QUICK_END__ */
    #ifdef __MMI_CALLSET_CUG__
        m_inCugId(0),
    #endif /* __MMI_CALLSET_CUG__ */
        m_inCtr(SRV_CALLSET_CTR_MODE_OFF)
        {}
    // Destructor
    virtual ~VappCallSetCntx() {}

public:
    mmi_sim_enum m_sim;

    srv_ss_action_type_enum m_inActType;
    srv_ss_call_type_enum m_inCallType;

    /* call forwarding */
    srv_ss_call_forward_type_enum m_inCfType;
    VfxWString *m_inCfNum;

//    VfxBool m_cfuVoice;
    VfxWString m_cfuNum;
//    VfxBool m_cfnrcVoice;
    VfxWString m_cfnrcNum;
//    VfxBool m_cfnryVoice;
    VfxWString m_cfnryNum;
    VfxU32 m_cfnryTime;
//    VfxBool m_cfbVoice;
    VfxWString m_cfbNum;
   
    /* call barring */
    srv_ss_call_bar_type_enum m_inCbType;

#ifdef __MMI_CH_QUICK_END__
    VfxBool m_inQuickEnd;
    VfxU32 m_inQuickEndTime;
#endif /* __MMI_CH_QUICK_END__ */

#ifdef __MMI_CALLSET_CUG__
    VfxU32 m_inCugId;
    VfxWString m_inCugName;
#endif /* __MMI_CALLSET_CUG__ */

    /* call time reminder */
    srv_callset_ctr_mode_enum m_inCtr;

    VappCallSetAsyncPageWeakPtr m_asyncPage;
};

extern VappCallSetCntx *callset_p;
extern void vapp_callset_attach_cell(VfxMainScr *mainScr);
extern "C" mmi_ret vapp_callset_hdlr_rsp(mmi_event_struct *info);


#endif /* __VAPP_CALLSET_H__ */

